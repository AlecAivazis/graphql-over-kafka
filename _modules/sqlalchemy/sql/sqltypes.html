

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sqlalchemy.sql.sqltypes &mdash; nautilus v0.2.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="nautilus v0.2.4 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> nautilus
          

          
          </a>

          
            
            
              <div class="version">
                v0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../handlers/index.html">Action Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../schema/index.html">Service API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../internals/index.html">Module Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">nautilus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>sqlalchemy.sql.sqltypes</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sqlalchemy.sql.sqltypes</h1><div class="highlight"><pre>
<span class="c1"># sql/sqltypes.py</span>
<span class="c1"># Copyright (C) 2005-2015 the SQLAlchemy authors and contributors</span>
<span class="c1"># &lt;see AUTHORS file&gt;</span>
<span class="c1">#</span>
<span class="c1"># This module is part of SQLAlchemy and is released under</span>
<span class="c1"># the MIT License: http://www.opensource.org/licenses/mit-license.php</span>

<span class="sd">&quot;&quot;&quot;SQL specific types.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">codecs</span>

<span class="kn">from</span> <span class="nn">.type_api</span> <span class="kn">import</span> <span class="n">TypeEngine</span><span class="p">,</span> <span class="n">TypeDecorator</span><span class="p">,</span> <span class="n">to_instance</span>
<span class="kn">from</span> <span class="nn">.elements</span> <span class="kn">import</span> <span class="n">quoted_name</span><span class="p">,</span> <span class="n">type_coerce</span><span class="p">,</span> <span class="n">_defer_name</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">exc</span><span class="p">,</span> <span class="n">util</span><span class="p">,</span> <span class="n">processors</span>
<span class="kn">from</span> <span class="nn">.base</span> <span class="kn">import</span> <span class="n">_bind_or_error</span><span class="p">,</span> <span class="n">SchemaEventTarget</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">operators</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">..util</span> <span class="kn">import</span> <span class="n">pickle</span>
<span class="kn">import</span> <span class="nn">decimal</span>

<span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">jython</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">array</span>


<span class="k">class</span> <span class="nc">_DateAffinity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Mixin date/time specific expression adaptations.</span>

<span class="sd">    Rules are implemented within Date,Time,Interval,DateTime, Numeric,</span>
<span class="sd">    Integer. Based on http://www.postgresql.org/docs/current/static</span>
<span class="sd">    /functions-datetime.html.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Comparator</span><span class="p">(</span><span class="n">TypeEngine</span><span class="o">.</span><span class="n">Comparator</span><span class="p">):</span>
        <span class="n">_blank_dict</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">immutabledict</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_adapt_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">other_comparator</span><span class="p">):</span>
            <span class="n">othertype</span> <span class="o">=</span> <span class="n">other_comparator</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">_type_affinity</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">op</span><span class="p">,</span> <span class="n">to_instance</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">_expression_adaptations</span><span class="o">.</span>
                    <span class="n">get</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blank_dict</span><span class="p">)</span><span class="o">.</span>
                    <span class="n">get</span><span class="p">(</span><span class="n">othertype</span><span class="p">,</span> <span class="n">NULLTYPE</span><span class="p">))</span>
            <span class="p">)</span>
    <span class="n">comparator_factory</span> <span class="o">=</span> <span class="n">Comparator</span>


<span class="k">class</span> <span class="nc">Concatenable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A mixin that marks a type as supporting &#39;concatenation&#39;,</span>
<span class="sd">    typically strings.&quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">Comparator</span><span class="p">(</span><span class="n">TypeEngine</span><span class="o">.</span><span class="n">Comparator</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_adapt_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">other_comparator</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="ow">is</span> <span class="n">operators</span><span class="o">.</span><span class="n">add</span> <span class="ow">and</span>
                    <span class="nb">isinstance</span><span class="p">(</span>
                        <span class="n">other_comparator</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">Concatenable</span><span class="o">.</span><span class="n">Comparator</span><span class="p">,</span> <span class="n">NullType</span><span class="o">.</span><span class="n">Comparator</span><span class="p">)</span>
                    <span class="p">)):</span>
                <span class="k">return</span> <span class="n">operators</span><span class="o">.</span><span class="n">concat_op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">type</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">type</span>

    <span class="n">comparator_factory</span> <span class="o">=</span> <span class="n">Comparator</span>


<span class="k">class</span> <span class="nc">String</span><span class="p">(</span><span class="n">Concatenable</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The base for all string and character types.</span>

<span class="sd">    In SQL, corresponds to VARCHAR.  Can also take Python unicode objects</span>
<span class="sd">    and encode to the database&#39;s encoding in bind params (and the reverse for</span>
<span class="sd">    result sets.)</span>

<span class="sd">    The `length` field is usually required when the `String` type is</span>
<span class="sd">    used within a CREATE TABLE statement, as VARCHAR requires a length</span>
<span class="sd">    on most databases.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;string&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">collation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">convert_unicode</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">unicode_error</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">_warn_on_bytestring</span><span class="o">=</span><span class="bp">False</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a string-holding type.</span>

<span class="sd">        :param length: optional, a length for the column for use in</span>
<span class="sd">          DDL and CAST expressions.  May be safely omitted if no ``CREATE</span>
<span class="sd">          TABLE`` will be issued.  Certain databases may require a</span>
<span class="sd">          ``length`` for use in DDL, and will raise an exception when</span>
<span class="sd">          the ``CREATE TABLE`` DDL is issued if a ``VARCHAR``</span>
<span class="sd">          with no length is included.  Whether the value is</span>
<span class="sd">          interpreted as bytes or characters is database specific.</span>

<span class="sd">        :param collation: Optional, a column-level collation for</span>
<span class="sd">          use in DDL and CAST expressions.  Renders using the</span>
<span class="sd">          COLLATE keyword supported by SQLite, MySQL, and Postgresql.</span>
<span class="sd">          E.g.::</span>

<span class="sd">            &gt;&gt;&gt; from sqlalchemy import cast, select, String</span>
<span class="sd">            &gt;&gt;&gt; print select([cast(&#39;some string&#39;, String(collation=&#39;utf8&#39;))])</span>
<span class="sd">            SELECT CAST(:param_1 AS VARCHAR COLLATE utf8) AS anon_1</span>

<span class="sd">          .. versionadded:: 0.8 Added support for COLLATE to all</span>
<span class="sd">             string types.</span>

<span class="sd">        :param convert_unicode: When set to ``True``, the</span>
<span class="sd">          :class:`.String` type will assume that</span>
<span class="sd">          input is to be passed as Python ``unicode`` objects,</span>
<span class="sd">          and results returned as Python ``unicode`` objects.</span>
<span class="sd">          If the DBAPI in use does not support Python unicode</span>
<span class="sd">          (which is fewer and fewer these days), SQLAlchemy</span>
<span class="sd">          will encode/decode the value, using the</span>
<span class="sd">          value of the ``encoding`` parameter passed to</span>
<span class="sd">          :func:`.create_engine` as the encoding.</span>

<span class="sd">          When using a DBAPI that natively supports Python</span>
<span class="sd">          unicode objects, this flag generally does not</span>
<span class="sd">          need to be set.  For columns that are explicitly</span>
<span class="sd">          intended to store non-ASCII data, the :class:`.Unicode`</span>
<span class="sd">          or :class:`.UnicodeText`</span>
<span class="sd">          types should be used regardless, which feature</span>
<span class="sd">          the same behavior of ``convert_unicode`` but</span>
<span class="sd">          also indicate an underlying column type that</span>
<span class="sd">          directly supports unicode, such as ``NVARCHAR``.</span>

<span class="sd">          For the extremely rare case that Python ``unicode``</span>
<span class="sd">          is to be encoded/decoded by SQLAlchemy on a backend</span>
<span class="sd">          that does natively support Python ``unicode``,</span>
<span class="sd">          the value ``force`` can be passed here which will</span>
<span class="sd">          cause SQLAlchemy&#39;s encode/decode services to be</span>
<span class="sd">          used unconditionally.</span>

<span class="sd">        :param unicode_error: Optional, a method to use to handle Unicode</span>
<span class="sd">          conversion errors. Behaves like the ``errors`` keyword argument to</span>
<span class="sd">          the standard library&#39;s ``string.decode()`` functions.   This flag</span>
<span class="sd">          requires that ``convert_unicode`` is set to ``force`` - otherwise,</span>
<span class="sd">          SQLAlchemy is not guaranteed to handle the task of unicode</span>
<span class="sd">          conversion.   Note that this flag adds significant performance</span>
<span class="sd">          overhead to row-fetching operations for backends that already</span>
<span class="sd">          return unicode objects natively (which most DBAPIs do).  This</span>
<span class="sd">          flag should only be used as a last resort for reading</span>
<span class="sd">          strings from a column with varied or corrupted encodings.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unicode_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">convert_unicode</span> <span class="o">!=</span> <span class="s1">&#39;force&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="n">ArgumentError</span><span class="p">(</span><span class="s2">&quot;convert_unicode must be &#39;force&#39; &quot;</span>
                                    <span class="s2">&quot;when unicode_error is set.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collation</span> <span class="o">=</span> <span class="n">collation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="o">=</span> <span class="n">convert_unicode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unicode_error</span> <span class="o">=</span> <span class="n">unicode_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_warn_on_bytestring</span> <span class="o">=</span> <span class="n">_warn_on_bytestring</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="ow">or</span> <span class="n">dialect</span><span class="o">.</span><span class="n">convert_unicode</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_unicode_binds</span> <span class="ow">and</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="o">!=</span> <span class="s1">&#39;force&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warn_on_bytestring</span><span class="p">:</span>
                    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">binary_type</span><span class="p">):</span>
                            <span class="n">util</span><span class="o">.</span><span class="n">warn_limited</span><span class="p">(</span>
                                <span class="s2">&quot;Unicode type received non-unicode &quot;</span>
                                <span class="s2">&quot;bind param value </span><span class="si">%r</span><span class="s2">.&quot;</span><span class="p">,</span>
                                <span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">ellipses_string</span><span class="p">(</span><span class="n">value</span><span class="p">),))</span>
                        <span class="k">return</span> <span class="n">value</span>
                    <span class="k">return</span> <span class="n">process</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">encoder</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">getencoder</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
                <span class="n">warn_on_bytestring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warn_on_bytestring</span>

                <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">text_type</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">encoder</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_error</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">warn_on_bytestring</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">warn_limited</span><span class="p">(</span>
                            <span class="s2">&quot;Unicode type received non-unicode bind &quot;</span>
                            <span class="s2">&quot;param value </span><span class="si">%r</span><span class="s2">.&quot;</span><span class="p">,</span>
                            <span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">ellipses_string</span><span class="p">(</span><span class="n">value</span><span class="p">),))</span>
                    <span class="k">return</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">process</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="n">wants_unicode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="ow">or</span> <span class="n">dialect</span><span class="o">.</span><span class="n">convert_unicode</span>
        <span class="n">needs_convert</span> <span class="o">=</span> <span class="n">wants_unicode</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">returns_unicode_strings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span> <span class="ow">or</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;force_nocheck&#39;</span><span class="p">))</span>
        <span class="n">needs_isinstance</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">needs_convert</span> <span class="ow">and</span>
            <span class="n">dialect</span><span class="o">.</span><span class="n">returns_unicode_strings</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span> <span class="o">!=</span> <span class="s1">&#39;force_nocheck&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">needs_convert</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">needs_isinstance</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_conditional_unicode_processor_factory</span><span class="p">(</span>
                    <span class="n">dialect</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_error</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_unicode_processor_factory</span><span class="p">(</span>
                    <span class="n">dialect</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">text_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">STRING</span>


<span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">String</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A variably sized string type.</span>

<span class="sd">    In SQL, usually corresponds to CLOB or TEXT. Can also take Python</span>
<span class="sd">    unicode objects and encode to the database&#39;s encoding in bind</span>
<span class="sd">    params (and the reverse for result sets.)  In general, TEXT objects</span>
<span class="sd">    do not have a length; while some databases will accept a length</span>
<span class="sd">    argument here, it will be rejected by others.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>


<span class="k">class</span> <span class="nc">Unicode</span><span class="p">(</span><span class="n">String</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A variable length Unicode string type.</span>

<span class="sd">    The :class:`.Unicode` type is a :class:`.String` subclass</span>
<span class="sd">    that assumes input and output as Python ``unicode`` data,</span>
<span class="sd">    and in that regard is equivalent to the usage of the</span>
<span class="sd">    ``convert_unicode`` flag with the :class:`.String` type.</span>
<span class="sd">    However, unlike plain :class:`.String`, it also implies an</span>
<span class="sd">    underlying column type that is explicitly supporting of non-ASCII</span>
<span class="sd">    data, such as ``NVARCHAR`` on Oracle and SQL Server.</span>
<span class="sd">    This can impact the output of ``CREATE TABLE`` statements</span>
<span class="sd">    and ``CAST`` functions at the dialect level, and can</span>
<span class="sd">    also affect the handling of bound parameters in some</span>
<span class="sd">    specific DBAPI scenarios.</span>

<span class="sd">    The encoding used by the :class:`.Unicode` type is usually</span>
<span class="sd">    determined by the DBAPI itself; most modern DBAPIs</span>
<span class="sd">    feature support for Python ``unicode`` objects as bound</span>
<span class="sd">    values and result set values, and the encoding should</span>
<span class="sd">    be configured as detailed in the notes for the target</span>
<span class="sd">    DBAPI in the :ref:`dialect_toplevel` section.</span>

<span class="sd">    For those DBAPIs which do not support, or are not configured</span>
<span class="sd">    to accommodate Python ``unicode`` objects</span>
<span class="sd">    directly, SQLAlchemy does the encoding and decoding</span>
<span class="sd">    outside of the DBAPI.   The encoding in this scenario</span>
<span class="sd">    is determined by the ``encoding`` flag passed to</span>
<span class="sd">    :func:`.create_engine`.</span>

<span class="sd">    When using the :class:`.Unicode` type, it is only appropriate</span>
<span class="sd">    to pass Python ``unicode`` objects, and not plain ``str``.</span>
<span class="sd">    If a plain ``str`` is passed under Python 2, a warning</span>
<span class="sd">    is emitted.  If you notice your application emitting these warnings but</span>
<span class="sd">    you&#39;re not sure of the source of them, the Python</span>
<span class="sd">    ``warnings`` filter, documented at</span>
<span class="sd">    http://docs.python.org/library/warnings.html,</span>
<span class="sd">    can be used to turn these warnings into exceptions</span>
<span class="sd">    which will illustrate a stack trace::</span>

<span class="sd">      import warnings</span>
<span class="sd">      warnings.simplefilter(&#39;error&#39;)</span>

<span class="sd">    For an application that wishes to pass plain bytestrings</span>
<span class="sd">    and Python ``unicode`` objects to the ``Unicode`` type</span>
<span class="sd">    equally, the bytestrings must first be decoded into</span>
<span class="sd">    unicode.  The recipe at :ref:`coerce_to_unicode` illustrates</span>
<span class="sd">    how this is done.</span>

<span class="sd">    See also:</span>

<span class="sd">        :class:`.UnicodeText` - unlengthed textual counterpart</span>
<span class="sd">        to :class:`.Unicode`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;unicode&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a :class:`.Unicode` object.</span>

<span class="sd">        Parameters are the same as that of :class:`.String`,</span>
<span class="sd">        with the exception that ``convert_unicode``</span>
<span class="sd">        defaults to ``True``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;convert_unicode&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;_warn_on_bytestring&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Unicode</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">UnicodeText</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;An unbounded-length Unicode string type.</span>

<span class="sd">    See :class:`.Unicode` for details on the unicode</span>
<span class="sd">    behavior of this object.</span>

<span class="sd">    Like :class:`.Unicode`, usage the :class:`.UnicodeText` type implies a</span>
<span class="sd">    unicode-capable type being used on the backend, such as</span>
<span class="sd">    ``NCLOB``, ``NTEXT``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;unicode_text&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Unicode-converting Text type.</span>

<span class="sd">        Parameters are the same as that of :class:`.Text`,</span>
<span class="sd">        with the exception that ``convert_unicode``</span>
<span class="sd">        defaults to ``True``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;convert_unicode&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;_warn_on_bytestring&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UnicodeText</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Integer</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for ``int`` integers.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;integer&#39;</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">NUMBER</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: need a dictionary object that will</span>
        <span class="c1"># handle operators generically here, this is incomplete</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Date</span><span class="p">:</span> <span class="n">Date</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">mul</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">div</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">truediv</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">SmallInteger</span><span class="p">(</span><span class="n">Integer</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for smaller ``int`` integers.</span>

<span class="sd">    Typically generates a ``SMALLINT`` in DDL, and otherwise acts like</span>
<span class="sd">    a normal :class:`.Integer` on the Python side.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;small_integer&#39;</span>


<span class="k">class</span> <span class="nc">BigInteger</span><span class="p">(</span><span class="n">Integer</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for bigger ``int`` integers.</span>

<span class="sd">    Typically generates a ``BIGINT`` in DDL, and otherwise acts like</span>
<span class="sd">    a normal :class:`.Integer` on the Python side.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;big_integer&#39;</span>


<span class="k">class</span> <span class="nc">Numeric</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for fixed precision numbers, such as ``NUMERIC`` or ``DECIMAL``.</span>

<span class="sd">    This type returns Python ``decimal.Decimal`` objects by default, unless</span>
<span class="sd">    the :paramref:`.Numeric.asdecimal` flag is set to False, in which case</span>
<span class="sd">    they are coerced to Python ``float`` objects.</span>

<span class="sd">    .. note::</span>

<span class="sd">        The :class:`.Numeric` type is designed to receive data from a database</span>
<span class="sd">        type that is explicitly known to be a decimal type</span>
<span class="sd">        (e.g. ``DECIMAL``, ``NUMERIC``, others) and not a floating point</span>
<span class="sd">        type (e.g. ``FLOAT``, ``REAL``, others).</span>
<span class="sd">        If the database column on the server is in fact a floating-point type</span>
<span class="sd">        type, such as ``FLOAT`` or ``REAL``, use the :class:`.Float`</span>
<span class="sd">        type or a subclass, otherwise numeric coercion between</span>
<span class="sd">        ``float``/``Decimal`` may or may not function as expected.</span>

<span class="sd">    .. note::</span>

<span class="sd">       The Python ``decimal.Decimal`` class is generally slow</span>
<span class="sd">       performing; cPython 3.3 has now switched to use the `cdecimal</span>
<span class="sd">       &lt;http://pypi.python.org/pypi/cdecimal/&gt;`_ library natively. For</span>
<span class="sd">       older Python versions, the ``cdecimal`` library can be patched</span>
<span class="sd">       into any application where it will replace the ``decimal``</span>
<span class="sd">       library fully, however this needs to be applied globally and</span>
<span class="sd">       before any other modules have been imported, as follows::</span>

<span class="sd">           import sys</span>
<span class="sd">           import cdecimal</span>
<span class="sd">           sys.modules[&quot;decimal&quot;] = cdecimal</span>

<span class="sd">       Note that the ``cdecimal`` and ``decimal`` libraries are **not</span>
<span class="sd">       compatible with each other**, so patching ``cdecimal`` at the</span>
<span class="sd">       global level is the only way it can be used effectively with</span>
<span class="sd">       various DBAPIs that hardcode to import the ``decimal`` library.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;numeric&#39;</span>

    <span class="n">_default_decimal_return_scale</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">decimal_return_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">asdecimal</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a Numeric.</span>

<span class="sd">        :param precision: the numeric precision for use in DDL ``CREATE</span>
<span class="sd">          TABLE``.</span>

<span class="sd">        :param scale: the numeric scale for use in DDL ``CREATE TABLE``.</span>

<span class="sd">        :param asdecimal: default True.  Return whether or not</span>
<span class="sd">          values should be sent as Python Decimal objects, or</span>
<span class="sd">          as floats.   Different DBAPIs send one or the other based on</span>
<span class="sd">          datatypes - the Numeric type will ensure that return values</span>
<span class="sd">          are one or the other across DBAPIs consistently.</span>

<span class="sd">        :param decimal_return_scale: Default scale to use when converting</span>
<span class="sd">         from floats to Python decimals.  Floating point values will typically</span>
<span class="sd">         be much longer due to decimal inaccuracy, and most floating point</span>
<span class="sd">         database types don&#39;t have a notion of &quot;scale&quot;, so by default the</span>
<span class="sd">         float type looks for the first ten decimal places when converting.</span>
<span class="sd">         Specfiying this value will override that length.  Types which</span>
<span class="sd">         do include an explicit &quot;.scale&quot; value, such as the base</span>
<span class="sd">         :class:`.Numeric` as well as the MySQL float types, will use the</span>
<span class="sd">         value of &quot;.scale&quot; as the default for decimal_return_scale, if not</span>
<span class="sd">         otherwise specified.</span>

<span class="sd">         .. versionadded:: 0.9.0</span>

<span class="sd">        When using the ``Numeric`` type, care should be taken to ensure</span>
<span class="sd">        that the asdecimal setting is apppropriate for the DBAPI in use -</span>
<span class="sd">        when Numeric applies a conversion from Decimal-&gt;float or float-&gt;</span>
<span class="sd">        Decimal, this conversion incurs an additional performance overhead</span>
<span class="sd">        for all result columns received.</span>

<span class="sd">        DBAPIs that return Decimal natively (e.g. psycopg2) will have</span>
<span class="sd">        better accuracy and higher performance with a setting of ``True``,</span>
<span class="sd">        as the native translation to Decimal reduces the amount of floating-</span>
<span class="sd">        point issues at play, and the Numeric type itself doesn&#39;t need</span>
<span class="sd">        to apply any further conversions.  However, another DBAPI which</span>
<span class="sd">        returns floats natively *will* incur an additional conversion</span>
<span class="sd">        overhead, and is still subject to floating point data loss - in</span>
<span class="sd">        which case ``asdecimal=False`` will at least remove the extra</span>
<span class="sd">        conversion overhead.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decimal_return_scale</span> <span class="o">=</span> <span class="n">decimal_return_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asdecimal</span> <span class="o">=</span> <span class="n">asdecimal</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_effective_decimal_return_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal_return_scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal_return_scale</span>
        <span class="k">elif</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_decimal_return_scale</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">NUMBER</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">asdecimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_decimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_float</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">asdecimal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_decimal</span><span class="p">:</span>
                <span class="c1"># we&#39;re a &quot;numeric&quot;, DBAPI will give us Decimal directly</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">util</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Dialect </span><span class="si">%s</span><span class="s1">+</span><span class="si">%s</span><span class="s1"> does *not* support Decimal &#39;</span>
                          <span class="s1">&#39;objects natively, and SQLAlchemy must &#39;</span>
                          <span class="s1">&#39;convert from floating point - rounding &#39;</span>
                          <span class="s1">&#39;errors and other issues may occur. Please &#39;</span>
                          <span class="s1">&#39;consider storing Decimal numbers as strings &#39;</span>
                          <span class="s1">&#39;or integers on this platform for lossless &#39;</span>
                          <span class="s1">&#39;storage.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">dialect</span><span class="o">.</span><span class="n">driver</span><span class="p">))</span>

                <span class="c1"># we&#39;re a &quot;numeric&quot;, DBAPI returns floats, convert.</span>
                <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_decimal_processor_factory</span><span class="p">(</span>
                    <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_decimal_return_scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_decimal</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_float</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">mul</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">div</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">truediv</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">Float</span><span class="p">(</span><span class="n">Numeric</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Type representing floating point types, such as ``FLOAT`` or ``REAL``.</span>

<span class="sd">    This type returns Python ``float`` objects by default, unless the</span>
<span class="sd">    :paramref:`.Float.asdecimal` flag is set to True, in which case they</span>
<span class="sd">    are coerced to ``decimal.Decimal`` objects.</span>

<span class="sd">    .. note::</span>

<span class="sd">        The :class:`.Float` type is designed to receive data from a database</span>
<span class="sd">        type that is explicitly known to be a floating point type</span>
<span class="sd">        (e.g. ``FLOAT``, ``REAL``, others)</span>
<span class="sd">        and not a decimal type (e.g. ``DECIMAL``, ``NUMERIC``, others).</span>
<span class="sd">        If the database column on the server is in fact a Numeric</span>
<span class="sd">        type, such as ``DECIMAL`` or ``NUMERIC``, use the :class:`.Numeric`</span>
<span class="sd">        type or a subclass, otherwise numeric coercion between</span>
<span class="sd">        ``float``/``Decimal`` may or may not function as expected.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">asdecimal</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">decimal_return_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a Float.</span>

<span class="sd">        :param precision: the numeric precision for use in DDL ``CREATE</span>
<span class="sd">           TABLE``.</span>

<span class="sd">        :param asdecimal: the same flag as that of :class:`.Numeric`, but</span>
<span class="sd">          defaults to ``False``.   Note that setting this flag to ``True``</span>
<span class="sd">          results in floating point conversion.</span>

<span class="sd">        :param decimal_return_scale: Default scale to use when converting</span>
<span class="sd">         from floats to Python decimals.  Floating point values will typically</span>
<span class="sd">         be much longer due to decimal inaccuracy, and most floating point</span>
<span class="sd">         database types don&#39;t have a notion of &quot;scale&quot;, so by default the</span>
<span class="sd">         float type looks for the first ten decimal places when converting.</span>
<span class="sd">         Specfiying this value will override that length.  Note that the</span>
<span class="sd">         MySQL float types, which do include &quot;scale&quot;, will use &quot;scale&quot;</span>
<span class="sd">         as the default for decimal_return_scale, if not otherwise specified.</span>

<span class="sd">         .. versionadded:: 0.9.0</span>

<span class="sd">        :param \**kwargs: deprecated.  Additional arguments here are ignored</span>
<span class="sd">         by the default :class:`.Float` type.  For database specific</span>
<span class="sd">         floats that support additional arguments, see that dialect&#39;s</span>
<span class="sd">         documentation for details, such as</span>
<span class="sd">         :class:`sqlalchemy.dialects.mysql.FLOAT`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asdecimal</span> <span class="o">=</span> <span class="n">asdecimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decimal_return_scale</span> <span class="o">=</span> <span class="n">decimal_return_scale</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span><span class="s2">&quot;Additional keyword arguments &quot;</span>
                                 <span class="s2">&quot;passed to Float ignored.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">asdecimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_decimal_processor_factory</span><span class="p">(</span>
                <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_effective_decimal_return_scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">mul</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">div</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">truediv</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">DateTime</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for ``datetime.datetime()`` objects.</span>

<span class="sd">    Date and time types return objects from the Python ``datetime``</span>
<span class="sd">    module.  Most DBAPIs have built in support for the datetime</span>
<span class="sd">    module, with the noted exception of SQLite.  In the case of</span>
<span class="sd">    SQLite, date and time types are stored as strings which are then</span>
<span class="sd">    converted back to datetime objects when rows are returned.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;datetime&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timezone</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a new :class:`.DateTime`.</span>

<span class="sd">        :param timezone: boolean.  If True, and supported by the</span>
<span class="sd">         backend, will produce &#39;TIMESTAMP WITH TIMEZONE&#39;. For backends</span>
<span class="sd">         that don&#39;t support timezone aware timestamps, has no</span>
<span class="sd">         effect.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="n">timezone</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">DATETIME</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">DateTime</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">Date</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for ``datetime.date()`` objects.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">DATETIME</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>
                <span class="n">Time</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="c1"># date - integer = date</span>
                <span class="n">Integer</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>

                <span class="c1"># date - date = integer.</span>
                <span class="n">Date</span><span class="p">:</span> <span class="n">Integer</span><span class="p">,</span>

                <span class="n">Interval</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>

                <span class="c1"># date - datetime = interval,</span>
                <span class="c1"># this one is not in the PG docs</span>
                <span class="c1"># but works</span>
                <span class="n">DateTime</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">Time</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for ``datetime.time()`` objects.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timezone</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="n">timezone</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">DATETIME</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">time</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Date</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Time</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">_Binary</span><span class="p">(</span><span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Define base behavior for binary types.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">binary_type</span>

    <span class="c1"># Python 3 - sqlite3 doesn&#39;t need the `Binary` conversion</span>
    <span class="c1"># here, though pg8000 does to indicate &quot;bytea&quot;</span>
    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">dbapi</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">DBAPIBinary</span> <span class="o">=</span> <span class="n">dialect</span><span class="o">.</span><span class="n">dbapi</span><span class="o">.</span><span class="n">Binary</span>

        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DBAPIBinary</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="c1"># Python 3 has native bytes() type</span>
    <span class="c1"># both sqlite3 and pg8000 seem to return it,</span>
    <span class="c1"># psycopg2 as of 2.5 returns &#39;memoryview&#39;</span>
    <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">py2k</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">jython</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
                            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span>
                        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">process</span> <span class="o">=</span> <span class="n">processors</span><span class="o">.</span><span class="n">to_str</span>
            <span class="k">return</span> <span class="n">process</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">coerce_compared_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :meth:`.TypeEngine.coerce_compared_value` for a description.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">_Binary</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">coerce_compared_value</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">BINARY</span>


<span class="k">class</span> <span class="nc">LargeBinary</span><span class="p">(</span><span class="n">_Binary</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for large binary byte data.</span>

<span class="sd">    The Binary type generates BLOB or BYTEA when tables are created,</span>
<span class="sd">    and also converts incoming values using the ``Binary`` callable</span>
<span class="sd">    provided by each DB-API.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;large_binary&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a LargeBinary type.</span>

<span class="sd">        :param length: optional, a length for the column for use in</span>
<span class="sd">          DDL statements, for those BLOB types that accept a length</span>
<span class="sd">          (i.e. MySQL).  It does *not* produce a *lengthed* BINARY/VARBINARY</span>
<span class="sd">          type - use the BINARY/VARBINARY types specifically for those.</span>
<span class="sd">          May be safely omitted if no ``CREATE</span>
<span class="sd">          TABLE`` will be issued.  Certain databases may require a</span>
<span class="sd">          *length* for use in DDL, and will raise an exception when</span>
<span class="sd">          the ``CREATE TABLE`` DDL is issued.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_Binary</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Binary</span><span class="p">(</span><span class="n">LargeBinary</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Deprecated.  Renamed to LargeBinary.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">util</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span><span class="s1">&#39;The Binary type has been renamed to &#39;</span>
                             <span class="s1">&#39;LargeBinary.&#39;</span><span class="p">)</span>
        <span class="n">LargeBinary</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SchemaType</span><span class="p">(</span><span class="n">SchemaEventTarget</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Mark a type as possibly requiring schema-level DDL for usage.</span>

<span class="sd">    Supports types that must be explicitly created/dropped (i.e. PG ENUM type)</span>
<span class="sd">    as well as types that are complimented by table or schema level</span>
<span class="sd">    constraints, triggers, and other rules.</span>

<span class="sd">    :class:`.SchemaType` classes can also be targets for the</span>
<span class="sd">    :meth:`.DDLEvents.before_parent_attach` and</span>
<span class="sd">    :meth:`.DDLEvents.after_parent_attach` events, where the events fire off</span>
<span class="sd">    surrounding the association of the type object with a parent</span>
<span class="sd">    :class:`.Column`.</span>

<span class="sd">    .. seealso::</span>

<span class="sd">        :class:`.Enum`</span>

<span class="sd">        :class:`.Boolean`</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">inherit_schema</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">quote</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">_create_events</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">quoted_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inherit_schema</span> <span class="o">=</span> <span class="n">inherit_schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_events</span> <span class="o">=</span> <span class="n">_create_events</span>

        <span class="k">if</span> <span class="n">_create_events</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="s2">&quot;before_create&quot;</span><span class="p">,</span>
                <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_metadata_create</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="s2">&quot;after_drop&quot;</span><span class="p">,</span>
                <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_metadata_drop</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="n">column</span><span class="o">.</span><span class="n">_on_table_attach</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_table</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inherit_schema</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">schema</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_events</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span>
            <span class="s2">&quot;before_create&quot;</span><span class="p">,</span>
            <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_on_table_create</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span>
            <span class="s2">&quot;after_drop&quot;</span><span class="p">,</span>
            <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_table_drop</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># TODO: what&#39;s the difference between self.metadata</span>
            <span class="c1"># and table.metadata here ?</span>
            <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
                <span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="s2">&quot;before_create&quot;</span><span class="p">,</span>
                <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_metadata_create</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
                <span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="s2">&quot;after_drop&quot;</span><span class="p">,</span>
                <span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_metadata_drop</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">_create_events</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">adapt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impltype</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="n">_create_events</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_create_events&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">impltype</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                        <span class="n">inherit_schema</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inherit_schema</span><span class="p">,</span>
                        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                        <span class="n">_create_events</span><span class="o">=</span><span class="n">_create_events</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">bind</span> <span class="ow">or</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bind</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">checkfirst</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Issue CREATE ddl for this type, if applicable.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">bind</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">_bind_or_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">bind</span><span class="p">,</span> <span class="n">checkfirst</span><span class="o">=</span><span class="n">checkfirst</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bind</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">checkfirst</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Issue DROP ddl for this type, if applicable.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">bind</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">_bind_or_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">bind</span><span class="p">,</span> <span class="n">checkfirst</span><span class="o">=</span><span class="n">checkfirst</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_table_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">_on_table_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_table_drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">_on_table_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_metadata_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">_on_metadata_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_metadata_drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect_impl</span><span class="p">(</span><span class="n">bind</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">_on_metadata_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Enum</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Generic Enum Type.</span>

<span class="sd">    The Enum type provides a set of possible string values which the</span>
<span class="sd">    column is constrained towards.</span>

<span class="sd">    By default, uses the backend&#39;s native ENUM type if available,</span>
<span class="sd">    else uses VARCHAR + a CHECK constraint.</span>

<span class="sd">    .. seealso::</span>

<span class="sd">        :class:`~.postgresql.ENUM` - PostgreSQL-specific type,</span>
<span class="sd">        which has additional functionality.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;enum&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">enums</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct an enum.</span>

<span class="sd">        Keyword arguments which don&#39;t apply to a specific backend are ignored</span>
<span class="sd">        by that backend.</span>

<span class="sd">        :param \*enums: string or unicode enumeration labels. If unicode</span>
<span class="sd">           labels are present, the `convert_unicode` flag is auto-enabled.</span>

<span class="sd">        :param convert_unicode: Enable unicode-aware bind parameter and</span>
<span class="sd">           result-set processing for this Enum&#39;s data. This is set</span>
<span class="sd">           automatically based on the presence of unicode label strings.</span>

<span class="sd">        :param metadata: Associate this type directly with a ``MetaData``</span>
<span class="sd">           object. For types that exist on the target database as an</span>
<span class="sd">           independent schema construct (Postgresql), this type will be</span>
<span class="sd">           created and dropped within ``create_all()`` and ``drop_all()``</span>
<span class="sd">           operations. If the type is not associated with any ``MetaData``</span>
<span class="sd">           object, it will associate itself with each ``Table`` in which it is</span>
<span class="sd">           used, and will be created when any of those individual tables are</span>
<span class="sd">           created, after a check is performed for its existence. The type is</span>
<span class="sd">           only dropped when ``drop_all()`` is called for that ``Table``</span>
<span class="sd">           object&#39;s metadata, however.</span>

<span class="sd">        :param name: The name of this type. This is required for Postgresql</span>
<span class="sd">           and any future supported database which requires an explicitly</span>
<span class="sd">           named type, or an explicitly named constraint in order to generate</span>
<span class="sd">           the type and/or a table that uses it.</span>

<span class="sd">        :param native_enum: Use the database&#39;s native ENUM type when</span>
<span class="sd">           available. Defaults to True. When False, uses VARCHAR + check</span>
<span class="sd">           constraint for all backends.</span>

<span class="sd">        :param schema: Schema name of this type. For types that exist on the</span>
<span class="sd">           target database as an independent schema construct (Postgresql),</span>
<span class="sd">           this parameter specifies the named schema in which the type is</span>
<span class="sd">           present.</span>

<span class="sd">           .. note::</span>

<span class="sd">                The ``schema`` of the :class:`.Enum` type does not</span>
<span class="sd">                by default make use of the ``schema`` established on the</span>
<span class="sd">                owning :class:`.Table`.  If this behavior is desired,</span>
<span class="sd">                set the ``inherit_schema`` flag to ``True``.</span>

<span class="sd">        :param quote: Set explicit quoting preferences for the type&#39;s name.</span>

<span class="sd">        :param inherit_schema: When ``True``, the &quot;schema&quot; from the owning</span>
<span class="sd">           :class:`.Table` will be copied to the &quot;schema&quot; attribute of this</span>
<span class="sd">           :class:`.Enum`, replacing whatever value was passed for the</span>
<span class="sd">           ``schema`` attribute.   This also takes effect when using the</span>
<span class="sd">           :meth:`.Table.tometadata` operation.</span>

<span class="sd">           .. versionadded:: 0.8</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enums</span> <span class="o">=</span> <span class="n">enums</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">native_enum</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;native_enum&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">convert_unicode</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;convert_unicode&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">convert_unicode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">enums</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">text_type</span><span class="p">):</span>
                    <span class="n">convert_unicode</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">convert_unicode</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enums</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enums</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">String</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                        <span class="n">convert_unicode</span><span class="o">=</span><span class="n">convert_unicode</span><span class="p">,</span>
                        <span class="p">)</span>
        <span class="n">SchemaType</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">generic_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">additional_kw</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;native_enum&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)],</span>
                                 <span class="n">to_inspect</span><span class="o">=</span><span class="p">[</span><span class="n">Enum</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">],</span>
                                 <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_should_create_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compiler</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">native_enum</span> <span class="ow">or</span> \
            <span class="ow">not</span> <span class="n">compiler</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_enum</span>

    <span class="nd">@util.dependencies</span><span class="p">(</span><span class="s2">&quot;sqlalchemy.sql.schema&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">native_enum</span><span class="p">:</span>
            <span class="n">SchemaType</span><span class="o">.</span><span class="n">_set_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">CheckConstraint</span><span class="p">(</span>
            <span class="n">type_coerce</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enums</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">_defer_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="n">_create_rule</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_should_create_constraint</span><span class="p">),</span>
            <span class="n">_type_bound</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">e</span><span class="o">.</span><span class="n">table</span> <span class="ow">is</span> <span class="n">table</span>

    <span class="k">def</span> <span class="nf">adapt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impltype</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="n">_create_events</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_create_events&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">impltype</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">impltype</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                            <span class="n">convert_unicode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_unicode</span><span class="p">,</span>
                            <span class="n">native_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">native_enum</span><span class="p">,</span>
                            <span class="n">inherit_schema</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inherit_schema</span><span class="p">,</span>
                            <span class="n">_create_events</span><span class="o">=</span><span class="n">_create_events</span><span class="p">,</span>
                            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">enums</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: why would we be here?</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Enum</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">impltype</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PickleType</span><span class="p">(</span><span class="n">TypeDecorator</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Holds Python objects, which are serialized using pickle.</span>

<span class="sd">    PickleType builds upon the Binary type to apply Python&#39;s</span>
<span class="sd">    ``pickle.dumps()`` to incoming objects, and ``pickle.loads()`` on</span>
<span class="sd">    the way out, allowing any pickleable Python object to be stored as</span>
<span class="sd">    a serialized binary field.</span>

<span class="sd">    To allow ORM change events to propagate for elements associated</span>
<span class="sd">    with :class:`.PickleType`, see :ref:`mutable_toplevel`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">impl</span> <span class="o">=</span> <span class="n">LargeBinary</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">,</span>
                 <span class="n">pickler</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">comparator</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a PickleType.</span>

<span class="sd">        :param protocol: defaults to ``pickle.HIGHEST_PROTOCOL``.</span>

<span class="sd">        :param pickler: defaults to cPickle.pickle or pickle.pickle if</span>
<span class="sd">          cPickle is not available.  May be any object with</span>
<span class="sd">          pickle-compatible ``dumps` and ``loads`` methods.</span>

<span class="sd">        :param comparator: a 2-arg callable predicate used</span>
<span class="sd">          to compare values of this type.  If left as ``None``,</span>
<span class="sd">          the Python &quot;equals&quot; operator is used to compare values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">=</span> <span class="n">protocol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickler</span> <span class="o">=</span> <span class="n">pickler</span> <span class="ow">or</span> <span class="n">pickle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comparator</span> <span class="o">=</span> <span class="n">comparator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PickleType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PickleType</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span>
                            <span class="bp">None</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">comparator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="n">impl_processor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">bind_processor</span><span class="p">(</span><span class="n">dialect</span><span class="p">)</span>
        <span class="n">dumps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickler</span><span class="o">.</span><span class="n">dumps</span>
        <span class="n">protocol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span>
        <span class="k">if</span> <span class="n">impl_processor</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">protocol</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">impl_processor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">protocol</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="n">impl_processor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">result_processor</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">)</span>
        <span class="n">loads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickler</span><span class="o">.</span><span class="n">loads</span>
        <span class="k">if</span> <span class="n">impl_processor</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">impl_processor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">compare_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparator</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparator</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span>


<span class="k">class</span> <span class="nc">Boolean</span><span class="p">(</span><span class="n">TypeEngine</span><span class="p">,</span> <span class="n">SchemaType</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A bool datatype.</span>

<span class="sd">    Boolean typically uses BOOLEAN or SMALLINT on the DDL side, and on</span>
<span class="sd">    the Python side deals in ``True`` or ``False``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;boolean&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">create_constraint</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">_create_events</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a Boolean.</span>

<span class="sd">        :param create_constraint: defaults to True.  If the boolean</span>
<span class="sd">          is generated as an int/smallint, also create a CHECK constraint</span>
<span class="sd">          on the table that ensures 1 or 0 as a value.</span>

<span class="sd">        :param name: if a CHECK constraint is generated, specify</span>
<span class="sd">          the name of the constraint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_constraint</span> <span class="o">=</span> <span class="n">create_constraint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_events</span> <span class="o">=</span> <span class="n">_create_events</span>

    <span class="k">def</span> <span class="nf">_should_create_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compiler</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">compiler</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_boolean</span>

    <span class="nd">@util.dependencies</span><span class="p">(</span><span class="s2">&quot;sqlalchemy.sql.schema&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_constraint</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">CheckConstraint</span><span class="p">(</span>
            <span class="n">type_coerce</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">_defer_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="n">_create_rule</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">portable_instancemethod</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_should_create_constraint</span><span class="p">),</span>
            <span class="n">_type_bound</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">e</span><span class="o">.</span><span class="n">table</span> <span class="ow">is</span> <span class="n">table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_boolean</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_boolean</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">boolean_to_int</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dialect</span><span class="o">.</span><span class="n">supports_native_boolean</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">processors</span><span class="o">.</span><span class="n">int_to_boolean</span>


<span class="k">class</span> <span class="nc">Interval</span><span class="p">(</span><span class="n">_DateAffinity</span><span class="p">,</span> <span class="n">TypeDecorator</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A type for ``datetime.timedelta()`` objects.</span>

<span class="sd">    The Interval type deals with ``datetime.timedelta`` objects.  In</span>
<span class="sd">    PostgreSQL, the native ``INTERVAL`` type is used; for others, the</span>
<span class="sd">    value is stored as a date which is relative to the &quot;epoch&quot;</span>
<span class="sd">    (Jan. 1, 1970).</span>

<span class="sd">    Note that the ``Interval`` type does not currently provide date arithmetic</span>
<span class="sd">    operations on platforms which do not support interval types natively. Such</span>
<span class="sd">    operations usually require transformation of both sides of the expression</span>
<span class="sd">    (such as, conversion of both sides into integer epoch values first) which</span>
<span class="sd">    currently is a manual procedure (such as via</span>
<span class="sd">    :attr:`~sqlalchemy.sql.expression.func`).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">impl</span> <span class="o">=</span> <span class="n">DateTime</span>
    <span class="n">epoch</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">native</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">second_precision</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">day_precision</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct an Interval object.</span>

<span class="sd">        :param native: when True, use the actual</span>
<span class="sd">          INTERVAL type provided by the database, if</span>
<span class="sd">          supported (currently Postgresql, Oracle).</span>
<span class="sd">          Otherwise, represent the interval data as</span>
<span class="sd">          an epoch value regardless.</span>

<span class="sd">        :param second_precision: For native interval types</span>
<span class="sd">          which support a &quot;fractional seconds precision&quot; parameter,</span>
<span class="sd">          i.e. Oracle and Postgresql</span>

<span class="sd">        :param day_precision: for native interval types which</span>
<span class="sd">          support a &quot;day precision&quot; parameter, i.e. Oracle.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Interval</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">native</span> <span class="o">=</span> <span class="n">native</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_precision</span> <span class="o">=</span> <span class="n">second_precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day_precision</span> <span class="o">=</span> <span class="n">day_precision</span>

    <span class="k">def</span> <span class="nf">adapt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">native</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s1">&#39;_adapt_from_generic_interval&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_adapt_from_generic_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
                <span class="n">native</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">native</span><span class="p">,</span>
                <span class="n">second_precision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">second_precision</span><span class="p">,</span>
                <span class="n">day_precision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">day_precision</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">bind_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="n">impl_processor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">bind_processor</span><span class="p">(</span><span class="n">dialect</span><span class="p">)</span>
        <span class="n">epoch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span>
        <span class="k">if</span> <span class="n">impl_processor</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">epoch</span> <span class="o">+</span> <span class="n">value</span>
                <span class="k">return</span> <span class="n">impl_processor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">epoch</span> <span class="o">+</span> <span class="n">value</span>
                <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="n">impl_processor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">result_processor</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">)</span>
        <span class="n">epoch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span>
        <span class="k">if</span> <span class="n">impl_processor</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">impl_processor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="k">return</span> <span class="n">value</span> <span class="o">-</span> <span class="n">epoch</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="k">return</span> <span class="n">value</span> <span class="o">-</span> <span class="n">epoch</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="nd">@util.memoized_property</span>
    <span class="k">def</span> <span class="nf">_expression_adaptations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Date</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                <span class="n">DateTime</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">,</span>
                <span class="n">Time</span><span class="p">:</span> <span class="n">Time</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Interval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">mul</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">truediv</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
            <span class="p">},</span>
            <span class="n">operators</span><span class="o">.</span><span class="n">div</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Numeric</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_type_affinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span>

    <span class="k">def</span> <span class="nf">coerce_compared_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :meth:`.TypeEngine.coerce_compared_value` for a description.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">coerce_compared_value</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">REAL</span><span class="p">(</span><span class="n">Float</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL REAL type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;REAL&#39;</span>


<span class="k">class</span> <span class="nc">FLOAT</span><span class="p">(</span><span class="n">Float</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL FLOAT type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;FLOAT&#39;</span>


<span class="k">class</span> <span class="nc">NUMERIC</span><span class="p">(</span><span class="n">Numeric</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL NUMERIC type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;NUMERIC&#39;</span>


<span class="k">class</span> <span class="nc">DECIMAL</span><span class="p">(</span><span class="n">Numeric</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL DECIMAL type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;DECIMAL&#39;</span>


<span class="k">class</span> <span class="nc">INTEGER</span><span class="p">(</span><span class="n">Integer</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL INT or INTEGER type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;INTEGER&#39;</span>
<span class="n">INT</span> <span class="o">=</span> <span class="n">INTEGER</span>


<span class="k">class</span> <span class="nc">SMALLINT</span><span class="p">(</span><span class="n">SmallInteger</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL SMALLINT type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;SMALLINT&#39;</span>


<span class="k">class</span> <span class="nc">BIGINT</span><span class="p">(</span><span class="n">BigInteger</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL BIGINT type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;BIGINT&#39;</span>


<span class="k">class</span> <span class="nc">TIMESTAMP</span><span class="p">(</span><span class="n">DateTime</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL TIMESTAMP type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;TIMESTAMP&#39;</span>

    <span class="k">def</span> <span class="nf">get_dbapi_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbapi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbapi</span><span class="o">.</span><span class="n">TIMESTAMP</span>


<span class="k">class</span> <span class="nc">DATETIME</span><span class="p">(</span><span class="n">DateTime</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL DATETIME type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;DATETIME&#39;</span>


<span class="k">class</span> <span class="nc">DATE</span><span class="p">(</span><span class="n">Date</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL DATE type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;DATE&#39;</span>


<span class="k">class</span> <span class="nc">TIME</span><span class="p">(</span><span class="n">Time</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL TIME type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;TIME&#39;</span>


<span class="k">class</span> <span class="nc">TEXT</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL TEXT type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;TEXT&#39;</span>


<span class="k">class</span> <span class="nc">CLOB</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The CLOB type.</span>

<span class="sd">    This type is found in Oracle and Informix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;CLOB&#39;</span>


<span class="k">class</span> <span class="nc">VARCHAR</span><span class="p">(</span><span class="n">String</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL VARCHAR type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;VARCHAR&#39;</span>


<span class="k">class</span> <span class="nc">NVARCHAR</span><span class="p">(</span><span class="n">Unicode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL NVARCHAR type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;NVARCHAR&#39;</span>


<span class="k">class</span> <span class="nc">CHAR</span><span class="p">(</span><span class="n">String</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL CHAR type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;CHAR&#39;</span>


<span class="k">class</span> <span class="nc">NCHAR</span><span class="p">(</span><span class="n">Unicode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL NCHAR type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;NCHAR&#39;</span>


<span class="k">class</span> <span class="nc">BLOB</span><span class="p">(</span><span class="n">LargeBinary</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL BLOB type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;BLOB&#39;</span>


<span class="k">class</span> <span class="nc">BINARY</span><span class="p">(</span><span class="n">_Binary</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL BINARY type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;BINARY&#39;</span>


<span class="k">class</span> <span class="nc">VARBINARY</span><span class="p">(</span><span class="n">_Binary</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL VARBINARY type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;VARBINARY&#39;</span>


<span class="k">class</span> <span class="nc">BOOLEAN</span><span class="p">(</span><span class="n">Boolean</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The SQL BOOLEAN type.&quot;&quot;&quot;</span>

    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;BOOLEAN&#39;</span>


<span class="k">class</span> <span class="nc">NullType</span><span class="p">(</span><span class="n">TypeEngine</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;An unknown type.</span>

<span class="sd">    :class:`.NullType` is used as a default type for those cases where</span>
<span class="sd">    a type cannot be determined, including:</span>

<span class="sd">    * During table reflection, when the type of a column is not recognized</span>
<span class="sd">      by the :class:`.Dialect`</span>
<span class="sd">    * When constructing SQL expressions using plain Python objects of</span>
<span class="sd">      unknown types (e.g. ``somecolumn == my_special_object``)</span>
<span class="sd">    * When a new :class:`.Column` is created, and the given type is passed</span>
<span class="sd">      as ``None`` or is not passed at all.</span>

<span class="sd">    The :class:`.NullType` can be used within SQL expression invocation</span>
<span class="sd">    without issue, it just has no behavior either at the expression</span>
<span class="sd">    construction level or at the bind-parameter/result processing level.</span>
<span class="sd">    :class:`.NullType` will result in a :exc:`.CompileError` if the compiler</span>
<span class="sd">    is asked to render the type itself, such as if it is used in a</span>
<span class="sd">    :func:`.cast` operation or within a schema creation operation such as that</span>
<span class="sd">    invoked by :meth:`.MetaData.create_all` or the :class:`.CreateTable`</span>
<span class="sd">    construct.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__visit_name__</span> <span class="o">=</span> <span class="s1">&#39;null&#39;</span>

    <span class="n">_isnull</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">literal_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;NULL&quot;</span>
        <span class="k">return</span> <span class="n">process</span>

    <span class="k">class</span> <span class="nc">Comparator</span><span class="p">(</span><span class="n">TypeEngine</span><span class="o">.</span><span class="n">Comparator</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_adapt_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">other_comparator</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_comparator</span><span class="p">,</span> <span class="n">NullType</span><span class="o">.</span><span class="n">Comparator</span><span class="p">)</span> <span class="ow">or</span> \
                    <span class="ow">not</span> <span class="n">operators</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">(</span><span class="n">op</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">type</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">other_comparator</span><span class="o">.</span><span class="n">_adapt_expression</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="n">comparator_factory</span> <span class="o">=</span> <span class="n">Comparator</span>


<span class="k">class</span> <span class="nc">MatchType</span><span class="p">(</span><span class="n">Boolean</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Refers to the return type of the MATCH operator.</span>

<span class="sd">    As the :meth:`.ColumnOperators.match` is probably the most open-ended</span>
<span class="sd">    operator in generic SQLAlchemy Core, we can&#39;t assume the return type</span>
<span class="sd">    at SQL evaluation time, as MySQL returns a floating point, not a boolean,</span>
<span class="sd">    and other backends might do something different.    So this type</span>
<span class="sd">    acts as a placeholder, currently subclassing :class:`.Boolean`.</span>
<span class="sd">    The type allows dialects to inject result-processing functionality</span>
<span class="sd">    if needed, and on MySQL will return floating-point values.</span>

<span class="sd">    .. versionadded:: 1.0.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="n">NULLTYPE</span> <span class="o">=</span> <span class="n">NullType</span><span class="p">()</span>
<span class="n">BOOLEANTYPE</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">()</span>
<span class="n">STRINGTYPE</span> <span class="o">=</span> <span class="n">String</span><span class="p">()</span>
<span class="n">INTEGERTYPE</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">()</span>
<span class="n">MATCHTYPE</span> <span class="o">=</span> <span class="n">MatchType</span><span class="p">()</span>

<span class="n">_type_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">int</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(),</span>
    <span class="nb">float</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">(),</span>
    <span class="nb">bool</span><span class="p">:</span> <span class="n">BOOLEANTYPE</span><span class="p">,</span>
    <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">(),</span>
    <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">:</span> <span class="n">Date</span><span class="p">(),</span>
    <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span> <span class="n">DateTime</span><span class="p">(),</span>
    <span class="n">dt</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="n">Time</span><span class="p">(),</span>
    <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">:</span> <span class="n">Interval</span><span class="p">(),</span>
    <span class="n">util</span><span class="o">.</span><span class="n">NoneType</span><span class="p">:</span> <span class="n">NULLTYPE</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">py3k</span><span class="p">:</span>
    <span class="n">_type_map</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="n">LargeBinary</span><span class="p">()</span>
    <span class="n">_type_map</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Unicode</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">_type_map</span><span class="p">[</span><span class="nb">unicode</span><span class="p">]</span> <span class="o">=</span> <span class="n">Unicode</span><span class="p">()</span>
    <span class="n">_type_map</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">String</span><span class="p">()</span>


<span class="c1"># back-assign to type_api</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">type_api</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">BOOLEANTYPE</span> <span class="o">=</span> <span class="n">BOOLEANTYPE</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">STRINGTYPE</span> <span class="o">=</span> <span class="n">STRINGTYPE</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">INTEGERTYPE</span> <span class="o">=</span> <span class="n">INTEGERTYPE</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">NULLTYPE</span> <span class="o">=</span> <span class="n">NULLTYPE</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">MATCHTYPE</span> <span class="o">=</span> <span class="n">MATCHTYPE</span>
<span class="n">type_api</span><span class="o">.</span><span class="n">_type_map</span> <span class="o">=</span> <span class="n">_type_map</span>

<span class="n">TypeEngine</span><span class="o">.</span><span class="n">Comparator</span><span class="o">.</span><span class="n">BOOLEANTYPE</span> <span class="o">=</span> <span class="n">BOOLEANTYPE</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Alec Aivazis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'v0.2.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>