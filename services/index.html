

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Services &mdash; nautilus v0.2.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="nautilus v0.2.4 documentation" href="../index.html"/>
        <link rel="next" title="Action Handlers" href="../handlers/index.html"/>
        <link rel="prev" title="Authentication" href="../intro/auth.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> nautilus
          

          
          </a>

          
            
            
              <div class="version">
                v0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../handlers/index.html">Action Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schema/index.html">Service API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/index.html">Module Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">nautilus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Services</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/services/index.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="services">
<h1>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h1>
<p>Services are the building block of nautilus clouds. Very simply, a
nautilus service is a standalone process that responds to actions sent
over the global event queue, maintains and mutates some internal state
according to the action, and provides a summary of that internal state via
a GraphQL API.</p>
<p>Nautilus provides extendible implementations of common services as well as a base
Service class which all act as good starting points for your own services:</p>
<dl class="class">
<dt id="nautilus.ModelService">
<em class="property">class </em><code class="descclassname">nautilus.</code><code class="descname">ModelService</code><span class="sig-paren">(</span><em>model</em>, <em>additonal_action_handler=&lt;function noop_handler&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/modelService.html#ModelService"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.ModelService" title="Permalink to this definition">¶</a></dt>
<dd><p>This service acts as the primary data store in your cloud. It manages
the records of a single model by listening for actions that indicate
a record mutation as well as emitting actions when the mutations have
finished (whether successfully or not). The external API is
automatically generated to match the given model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>nautilus.BaseModel</em>) &#8211; The nautilus model to manage.</li>
<li><strong>additonal_action_handler</strong> (<em>optional, function</em>) &#8211; An action handler
to be called alongside the internal ones.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nautilus</span> <span class="kn">import</span> <span class="n">ModelService</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Text</span>
<span class="kn">from</span> <span class="nn">nautilus.models</span> <span class="kn">import</span> <span class="n">HasID</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">CRUDNotificationCreator</span>


<span class="c1"># these mixins provide make the model &quot;live&quot;. For more information,</span>
<span class="c1"># see foo_bar.</span>
<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">CRUDNotificationCreator</span><span class="p">,</span> <span class="n">HasID</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ServiceConfig</span><span class="p">:</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s1">&#39;sqlite:////tmp/models.db&#39;</span>


<span class="n">service</span> <span class="o">=</span> <span class="n">ModelService</span><span class="p">(</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">configObject</span> <span class="o">=</span> <span class="n">ServiceConfig</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nautilus.ConnectionService">
<em class="property">class </em><code class="descclassname">nautilus.</code><code class="descname">ConnectionService</code><span class="sig-paren">(</span><em>services</em>, <em>additonal_action_handler=&lt;function noop_handler&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/connectionService.html#ConnectionService"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.ConnectionService" title="Permalink to this definition">¶</a></dt>
<dd><p>This service manages a connection between any number of other services.
The underlying schema and database are automatically generated to
match the primary keys of the linked services.</p>
<p>This service will listen for actions indicating the deletion of a related
model and remove any related fields to maintain consistency. And provides
a way for the api gateway to deduce the relationship between services when
summarizing the cloud.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>services</strong> (<em>list of nautilus.Service</em>) &#8211; The list of services to connect.</li>
<li><strong>additonal_action_handler</strong> (<em>optional, function</em>) &#8211; An action handler
to be called alongside the internal ones.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># external imports</span>
<span class="kn">from</span> <span class="nn">nautilus</span> <span class="kn">import</span> <span class="n">ConnectionService</span>

<span class="c1"># the services to connect</span>
<span class="kn">from</span> <span class="nn">local.directory</span> <span class="kn">import</span> <span class="n">service</span> <span class="k">as</span> <span class="n">service_one</span>
<span class="kn">from</span> <span class="nn">other.local.directory</span> <span class="kn">import</span> <span class="n">service</span> <span class="k">as</span> <span class="n">service_two</span>

<span class="k">class</span> <span class="nc">ServiceConfig</span><span class="p">:</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s1">&#39;sqlite:////tmp/connections.db&#39;</span>

<span class="n">service</span> <span class="o">=</span> <span class="n">ConnectionService</span><span class="p">(</span>
    <span class="n">services</span> <span class="o">=</span> <span class="p">[</span><span class="n">service_one</span><span class="p">,</span> <span class="n">service_two</span><span class="p">],</span>
    <span class="n">configObject</span> <span class="o">=</span> <span class="n">ServiceConfig</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nautilus.APIGateway">
<em class="property">class </em><code class="descclassname">nautilus.</code><code class="descname">APIGateway</code><span class="sig-paren">(</span><em>schema</em>, <em>action_handler=&lt;function noop_handler&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/apiGateway.html#APIGateway"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.APIGateway" title="Permalink to this definition">¶</a></dt>
<dd><p>This provides a single endpoint that other services and clients can
use to query the cloud without worrying about the distributed nature
of the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>schema</strong> (<em>graphql.core.type.GraphQLSchema</em>) &#8211; The schema to use that
encapsultes the overall topology of the cloud.</li>
<li><strong>action_handler</strong> (<em>optional, function</em>) &#8211; The callback function fired
when an action is recieved. If None, the service does not
connect to the action queue.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># external imports</span>
<span class="kn">from</span> <span class="nn">nautilus</span> <span class="kn">import</span> <span class="n">APIGateway</span>
<span class="c1"># local imports</span>
<span class="kn">from</span> <span class="nn">.schema</span> <span class="kn">import</span> <span class="n">schema</span>

<span class="c1"># create a nautilus service with just the schema</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">APIGateway</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nautilus.AuthService">
<em class="property">class </em><code class="descclassname">nautilus.</code><code class="descname">AuthService</code><span class="sig-paren">(</span><em>action_handler=&lt;function noop_handler&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/authService.html#AuthService"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.AuthService" title="Permalink to this definition">¶</a></dt>
<dd><p>This service handles user authentication for the entire cloud and is
the only service with access to the users passwords. As such, this
service does not provide any sort of external schema, nor does it
respond to actions by default. It&#8217;s sole purpose is to collect the
necessary information from the user and provide that user with a way
to provid valid credentials to other services.</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nautilus</span> <span class="kn">import</span> <span class="n">AuthService</span>

<span class="k">class</span> <span class="nc">ServiceConfig</span><span class="p">:</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s1">&#39;sqlite:////tmp/models.db&#39;</span>

<span class="n">service</span> <span class="o">=</span> <span class="n">AuthService</span><span class="p">(</span>
    <span class="n">configObject</span> <span class="o">=</span> <span class="n">ServiceConfig</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nautilus.Service">
<em class="property">class </em><code class="descclassname">nautilus.</code><code class="descname">Service</code><span class="sig-paren">(</span><em>name</em>, <em>schema=None</em>, <em>actionHandler=None</em>, <em>configObject=None</em>, <em>auto_register=True</em>, <em>auth=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/service.html#Service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.Service" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the base class for all services that are part of a nautilus
cloud. This class provides basic functionalities such as registration,
responding to actions, and predictable api endpoints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>actionHandler</strong> (<em>optional, function</em>) &#8211; The callback function fired when
an action is recieved. If None, the service does not connect to the
action queue.</li>
<li><strong>auth</strong> (<em>optional, bool, default = True</em>) &#8211; Whether or not the service should add
authentication requirements.</li>
<li><strong>auto_register</strong> (<em>optional, bool</em>) &#8211; Whether or not the service should
register itself when ran</li>
<li><strong>configObject</strong> (<em>optional, class</em>) &#8211; A python class to use for configuring the
service.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; The name of the service. This will be used to
register the service with the registry as act as the designator
for a ServiceObjectType.</li>
<li><strong>schema</strong> (<em>optional, graphql.core.type.GraphQLSchema</em>) &#8211; The GraphQL schema
which acts as a basis for the external API. If None, no endpoints are
added to the service.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nautilus</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">nautilus.api</span> <span class="kn">import</span> <span class="n">create_model_schema</span>
<span class="kn">from</span> <span class="nn">nautilus.network</span> <span class="kn">import</span> <span class="n">CRUDHandler</span>
<span class="kn">from</span> <span class="nn">nautilus.models</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>


<span class="c1"># you could also make your own</span>
<span class="n">api_schema</span> <span class="o">=</span> <span class="n">create_model_schema</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span>
<span class="n">action_handler</span> <span class="o">=</span> <span class="n">CRUDHandler</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span>


<span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;My Awesome Service&#39;</span><span class="p">,</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">api_schema</span><span class="p">,</span>
    <span class="n">actionHandler</span> <span class="o">=</span> <span class="n">action_handler</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="nautilus.Service.use_blueprint">
<code class="descname">use_blueprint</code><span class="sig-paren">(</span><em>blueprint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nautilus/services/service.html#Service.use_blueprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nautilus.Service.use_blueprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a flask blueprint to the internal application</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../handlers/index.html" class="btn btn-neutral float-right" title="Action Handlers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../intro/auth.html" class="btn btn-neutral" title="Authentication" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Alec Aivazis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.2.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>